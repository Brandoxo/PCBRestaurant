import{y as w,g as a,o as s,b as d,i as p,F as f,x,f as y,t as g,S as _,q as S,z as C}from"./app-CXnACmzc.js";const D={class:"bg-white p-6 rounded-lg shadow-md flex overflow-y-auto justify-between max-h-64 hover:scale-[1.02] transition-all transform ease-in-out duration-300"},E={class:"flex flex-col gap-2"},B={key:0,src:"assets/icons/svg/details/utensils.svg",alt:"Food Icon",class:"inline w-5 ml-2 cursor-pointer"},I={key:1,src:"assets/icons/svg/details/drink.svg",alt:"Drink Icon",class:"inline w-5 ml-2 cursor-pointer"},T={key:1,class:"text-gray-400"},q={key:0,class:"h-fit overflow-auto flex flex-col gap-2 items-end"},O={key:0,class:"text-center"},N={key:1,class:"text-gray-400"},$={class:"bg-white p-6 rounded-lg shadow-md flex h-fit justify-between hover:scale-[1.02] transition-all transform ease-in-out duration-300"},j={class:"flex items-center gap-4"},V={class:"font-bold text-2xl 2xl:text-3xl"},F={__name:"OrderDetails",props:{order:Object},setup(n){const t=n,i=w().props.auth.user;console.log("order prop in <OrderDetails>: ",t.order);const k=[1,2,3,4,6,7,8,20],b=[5,9,10,11,12,13,14,15,16,17,18,19],m=()=>{_.fire({icon:"info",title:"Estás segur@ de cobrar la orden?",text:"Asegurate primero de haber cobrado el monto correcto.",showCancelButton:!0,confirmButtonText:"Sí, cobrar",cancelButtonText:"Cancelar",confirmButtonColor:"#28a745",cancelButtonColor:"#d33"}).then(c=>{c.isConfirmed&&t.order&&t.order.id&&t.order.order_details&&(t.order.order_details.forEach(e=>{S.post("/Sales/Create",{order_id:t.order.id,product_id:e.product_id,user_id:i.id,cash_audit_id:null,quantity:e.quantity,unit_price:e.unit_price??(e.product?e.product.price:0),subtotal:e.total??e.quantity*(e.unit_price??(e.product?e.product.price:0)),date_time:new Date().toISOString().slice(0,19).replace("T"," ")},{onSuccess:()=>{console.log("Sale created successfully for product",e.product_id)},onError:l=>{console.error("Error creating sale for product",e.product_id,l)}})}),_.fire({icon:"success",title:"¡Venta creada exitosamente!",showConfirmButton:!1,timer:1500}))})},v=()=>{if(t.order&&t.order.id){const c={total:t.order.total,items:t.order.order_details.length,cash:t.order.total,change:0,user_id:i.name,updated_at:new Date().toISOString().slice(0,19).replace("T"," "),created_at:new Date().toISOString().slice(0,19).replace("T"," "),id:t.order.id,user:{id:i.id,name:i.name,email:i.email,role:i.role}},e=t.order.order_details.map(r=>({price:r.unit_price??(r.product?r.product.price:0),quantity:r.quantity,name:r.product?r.product.name:""})),l={name:"Hotel Ronda Minerva",address:"Av. Adolfo López Mateos Sur 265, Jardines del Bosque, 44520 Guadalajara, Jal.",phone:"33 3121 4700"};C.get("/print-ticket/",{params:{data:{ticketData:c,ticketItems:e,businessInfo:l}}}).then(r=>{if(r.data&&r.data.printData){const u="print://"+r.data.printData;console.clear(),console.log(u),window.location.href=u,console.log("Ticket data sent successfully:",r.data)}else console.error("No print data received from server.")}).catch(r=>{console.error("Error sending ticket data:",r)})}else console.error("No order data available to print ticket.")};return(c,e)=>{var l,r,u,h;return s(),a(f,null,[e[2]||(e[2]=d("h2",{class:"text-lg font-semibold mt-2 mb- text-center text-white"}," Detalles de la orden ",-1)),d("div",D,[d("div",E,[n.order&&n.order.order_details&&n.order.order_details.length?(s(!0),a(f,{key:0},x(n.order.order_details,o=>(s(),a("span",{key:o.id},[o.product&&k.includes(o.product.category_id)?(s(),a("img",B)):o.product&&b.includes(o.product.category_id)?(s(),a("img",I)):p("",!0),y(" "+g(o.quantity)+" x "+g(o.product?o.product.name:""),1)]))),128)):(s(),a("span",T,"No hay detalles para esta orden."))]),n.order&&n.order.order_details&&n.order.order_details.length?(s(),a("div",q,[(s(!0),a(f,null,x(n.order.order_details,o=>(s(),a("div",{key:o.id},[o.product&&o.product.category_id===2?(s(),a("span",O)):p("",!0),y(" $ "+g(o.unit_price),1)]))),128))])):(s(),a("span",N,"No hay detalles para esta orden."))]),((l=n.order)==null?void 0:l.status)==="En curso"?(s(),a("button",{key:0,onClick:e[0]||(e[0]=o=>c.$inertia.get(`/Order/Edit/${n.order.id}`)),class:"bg-orangeYellow hover:bg-yellow-600 transform transition-all duration-300 ease-in-out text-white font-bold py-2 px-4 rounded"}," Editar Orden ")):p("",!0),d("div",$,[e[1]||(e[1]=d("h3",{class:"font-bold text-3xl"},"Total:",-1)),d("div",j,[d("span",V," $ "+g((r=t.order)!=null&&r.total?t.order.total:"0.00"),1),((u=t.order)==null?void 0:u.status)==="En curso"?(s(),a("button",{key:0,onClick:m,class:"bg-approveGreen hover:bg-green-900 transition-all transform duration-300 ease-in-out text-white px-4 py-2 rounded-lg"}," Cobrar ")):p("",!0),((h=t.order)==null?void 0:h.status)==="En curso"?(s(),a("button",{key:1,onClick:v,class:"bg-approveGreen hover:bg-green-900 transition-all transform duration-300 ease-in-out text-white px-4 py-2 rounded-lg"}," Imprimir Ticket ")):p("",!0)])])],64)}}};export{F as default};
