import{m as g,j,B as P,g as l,i as b,o as n,b as s,k as S,z as q,F as O,x as y,t as u,C as B}from"./app-1_flsrAA.js";const G={key:0,class:"w-full px-8"},I={class:"bg-gray-100 p-8 rounded-xl shadow-lg hover:scale-[1.01] transform transition-transform duration-300 ease-in-out"},M={key:0,class:"mt-4"},D=["value"],V={key:0,class:"text-center text-gray-500"},$={class:"list-disc list-inside max-h-48 2xl:max-h-[30rem] overflow-y-auto grid grid-cols-4 2xl:grid-cols-6 gap-4"},A={class:"bg-white rounded shadow flex justify-between items-center flex-col"},F=["src"],N={class:"font-bold"},R={class:"font-extrabold text-black text-lg mb-"},z={class:"flex justify-evenly w-full m-4 text-center items-center"},E=["onClick"],L={class:"text-lg font-bold text-gray-700"},U=["onClick"],J={__name:"MakeOrder",props:{tables:Object,orders:Object,selectedTable:Object,currentOrder:Object},emits:["closeOptions","order-saved"],setup(a,{emit:h}){const e=a,v=h;function _(){v("closeOptions"),x(),console.log("Close Options clicked, order reset to normal state:",e.currentOrder)}const w=()=>{v("order-saved",{...e.currentOrder}),x(),console.log("Order saved and reset to empty state:",e.currentOrder)},x=()=>{e.currentOrder.mesa_id=null,e.currentOrder.items=[],console.log("Order reset to empty state:",e.currentOrder)},d=g([]),f=g(!1),c=g("all"),p=j(()=>c.value==="all"?d.value.filter(t=>t.is_active):d.value.filter(t=>t.category.name===c.value&&t.is_active)),k=async()=>{try{const t=await B.get(route("products.get"));d.value=t.data.data,f.value=!0,console.log("Products data fetched successfully:",d.value)}catch(t){console.error("There was an error fetching the products data!",t)}},C=(t,o)=>{e.currentOrder.mesa_id||(e.currentOrder.mesa_id=o);const r=e.currentOrder.items.find(i=>i.product_id===t.id);r?r.quantity+=1:e.currentOrder.items.push({product_id:t.id,quantity:1,price:t.price,product:t}),console.log("========================================="),console.log("Current Order:",e.currentOrder),console.log("Add to Order clicked"),console.log("Product added to order:",t),console.log("Current Order:",e.currentOrder)},T=t=>{const o=e.currentOrder.items.findIndex(r=>r.product_id===t);o!==-1&&(e.currentOrder.items[o].quantity>1?e.currentOrder.items[o].quantity-=1:e.currentOrder.items.splice(o,1)),console.log("Remove from Order clicked"),console.log("Product removed from order:",t),console.log("Current Order:",e.currentOrder)};return P(()=>{var t;console.log("Selected Table Prop:",e.selectedTable),e.currentOrder.mesa_id=(t=e.selectedTable)!=null&&t.number?e.selectedTable.number:null,k(),console.log("Component mounted.")}),console.log(e),(t,o)=>a.selectedTable?(n(),l("div",G,[s("div",I,[o[4]||(o[4]=s("p",{class:"text-center"},"Selecciona una categoría del Menú",-1)),f.value?(n(),l("div",M,[S(s("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>c.value=r),class:"border p-2 rounded-lg w-full mb-4"},[o[1]||(o[1]=s("option",{disabled:"",value:""},"Seleccionar categoría",-1)),o[2]||(o[2]=s("option",{value:"all"},"Todas las categorías",-1)),(n(!0),l(O,null,y([...new Set(d.value.map(r=>r.category.name))],r=>(n(),l("option",{key:r,value:r},u(r),9,D))),128))],512),[[q,c.value]]),p.value.length>0?(n(),l("div",V,[o[3]||(o[3]=s("h4",{class:"text-xl font-semibold mb-2"},"Productos Disponibles:",-1)),s("ul",$,[(n(!0),l(O,null,y(p.value,r=>{var i;return n(),l("li",{key:r.id,class:"mb-1 flex flex-col"},[s("div",A,[s("img",{src:r.image,alt:"Product Image",class:"h-40 w-full 2xl:max-w-40 object-cover mb-2"},null,8,F),s("span",N,u(r.name),1),s("span",R,"$"+u(r.price),1),s("div",z,[s("button",{class:"text-sm rounded-md px-4 py-1 uppercase font-extrabold bg-red-600/80 text-white hover:bg-red-600",onClick:m=>T(r.id)},"-",8,E),s("span",L,u(((i=a.currentOrder.items.find(m=>m.product_id===r.id))==null?void 0:i.quantity)||0),1),s("button",{class:"text-sm rounded-md px-4 py-1 uppercase font-extrabold bg-approveGreen/80 text-white hover:bg-approveGreen",onClick:m=>C(r,a.selectedTable.number)},"+",8,U)])])])}),128))])])):b("",!0)])):b("",!0),s("div",{class:"flex justify-between mt-6"},[s("button",{class:"mt-4 px-4 py-2 bg-blue-500 text-white rounded",onClick:_},"Cerrar"),s("button",{class:"mt-4 px-4 py-2 bg-blue-500 text-white rounded",onClick:w},"Guardar orden")])])])):b("",!0)}};export{J as default};
