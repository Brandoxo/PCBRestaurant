import{_ as A}from"./StatusBadge-CTBakDMp.js";import{g as n,o as d,b as t,a as _,f as N,t as i,F as h,s as p,n as T,r as v,z as B,j as D,l as E,G as L,S as m,i as V}from"./app-CAE0YkQQ.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"flex mb- justify-evenly items-center"},$={class:"md:text-lg lg:text-xl"},M={class:"font-extrabold"},F={class:"text-center text-3xl font-bold"},G={class:"flex justify-center items-center text-sm mt-2 gap-2"},H={class:"text-center text-secondary"},J={class:"text-center text-secondary"},R={class:"mt-2 w-full border rounded px-2 py-1"},W=["value"],q={__name:"Orders",props:{order:Object},setup(e){return console.log("order:",e.order.order_details),(b,o)=>(d(),n("div",{class:T(["bg-white p-2 rounded-lg shadow-md mt-4 max-w-md mx-auto w-full",e.order.status==="Cancelada"?"opacity-50 border-2 border-red-500":"",e.order.status==="Completada"?"border-2 border-green-500 opacity-50":""])},[t("div",z,[t("h2",$,[o[0]||(o[0]=N(" Orden ",-1)),t("span",M,"ID #"+i(e.order.id??"0000"),1)]),_(A,{status:e.order.status},null,8,["status"])]),t("h2",F," Mesa "+i(e.order.table.number??"-"),1),t("div",G,[t("p",H,i(e.order.date_time?new Date(e.order.date_time).toLocaleTimeString():"-"),1),o[1]||(o[1]=t("span",{class:"text-secondary"},"|",-1)),t("p",J,i(e.order.date_time?new Date(e.order.date_time).toLocaleDateString():"-"),1)]),t("select",R,[o[2]||(o[2]=t("option",{class:"text-center",disabled:"",selected:""}," Ver menú de la Orden ",-1)),(d(!0),n(h,null,p(e.order.order_details,s=>(d(),n("option",{disabled:"",key:s.id,value:s.product.id},i(s.product.name)+" x"+i(s.quantity),9,W))),128))])],2))}},P=["onClick","gs-x","gs-y","data-gs-id"],K={__name:"AllOrders",props:{orders:Array},emits:["select"],setup(e,{emit:y}){const b=e,o=y,s=v(x()),f=v(null);let c;const g=B().props.auth.user,k=D(()=>g&&g.permissions&&g.permissions.includes("hide orders")),l=v(JSON.parse(localStorage.getItem("deletedOrderIds")||"[]"));function w(){localStorage.setItem("deletedOrderIds",JSON.stringify(l.value))}function x(){return window.innerWidth<1536?1:window.innerWidth<2048?2:3}function S(){c&&c.column(x())}return E(()=>{s.value=x(),f.value&&(c=L.init({cellHeight:180,column:s.value,resizable:{handles:"none"},removable:!0,removeTimeout:100},f.value),c.on("removed",function(C,O){O.forEach(r=>{const a=r.el.getAttribute("data-gs-id"),u=b.orders.find(I=>I.id.toString()===a);!l.value.includes(a)&&u.status==="Completada"?(l.value.push(a),m.fire({title:"Orden eliminada",text:"La orden ha sido eliminada correctamente.",icon:"success",confirmButtonText:"Aceptar"}),w()):u.status==="Cancelada"&&k.value?(l.value.push(a),m.fire({title:"Orden Eliminada",text:"Orden Cancelada eliminada exitosamente.",icon:"success",confirmButtonText:"Aceptar"}),w()):u.status==="En curso"?m.fire({title:"Orden en curso...",text:"No es posible eliminar las órdenes en curso.",icon:"error",confirmButtonText:"Aceptar"}).then(()=>{location.reload()}):m.fire({title:"No se puede eliminar",text:"Tus permisos de usuario no permite eliminar Órdenes Canceladas. Solicite a un administrador.",icon:"error",confirmButtonText:"Aceptar"}).then(()=>{location.reload()})})}),window.addEventListener("resize",S))}),(C,O)=>(d(),n("div",{ref_key:"gridRef",ref:f,class:"grid-stack"},[!e.orders||e.orders.length===0?(d(),n(h,{key:0},p(15,r=>t("div",{key:r,class:"animate-pulse bg-gray-300 2xl:w-56 h-28 rounded-lg grid-stack-item"})),64)):V("",!0),(d(!0),n(h,null,p(e.orders.filter(r=>!l.value.includes(r.id.toString())),(r,a)=>(d(),n("div",{key:r.id,onClick:u=>o("select",r),class:"cursor-pointer overflow-y-auto hover:scale-[1.03] transition-all transform ease-in-out duration-300 grid-stack-item","gs-x":a%s.value,"gs-y":Math.floor(a/s.value),"gs-width":1,"gs-height":1,"data-gs-id":r.id},[_(q,{order:r},null,8,["order"])],8,P))),128))],512))}},Y=j(K,[["__scopeId","data-v-cfc300c2"]]);export{Y as default};
