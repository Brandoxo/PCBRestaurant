import{m as i,y as N,j as w,g as c,o as m,b as e,a as r,k as p,p as v,F as C,q as V,i as L,t as g,w as _,A as j,f as U,S as A,s as h,x as b}from"./app-CxbOl7Wq.js";import{_ as R}from"./Modal-D4nDFCW4.js";import{_ as z}from"./StatusBadge-DgB45FVv.js";import{C as D}from"./CancelButton-xEHH7b-Z.js";import{_ as x}from"./InputError-J0p0Vn3k.js";import{_ as y}from"./InputLabel-46o4Sx4M.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"bg-white p-4 rounded-2xl"},F={class:"w-full mt-2 border"},G={class:"border p-2 text-center"},P={class:"border p-2 text-center"},I={class:"border p-2 text-center"},O={class:"border p-2 text-center"},Q={key:0,class:"border p-2 flex gap-2 justify-center"},H=["onClick"],J=["onClick"],K={class:"p-6"},W={class:"flex flex-col"},X={class:"flex justify-between"},Y={class:"flex justify-between"},le={__name:"ListTables",props:{mesas:Object},setup(E){const f=i({errors:{}}),n=E,l=i(!1),a=i({}),d=N().props.auth.user;w(()=>(console.log("DETAILS:",d),d&&d.roles&&d.roles.includes("Admin")));const T=()=>{l.value=!1},B=o=>{const s=n.mesas.data.find(t=>t.id===o);a.value=s?{...s}:{id:o,number:"",status:"",capacity:""},l.value=!0},k=o=>{var s;if(a.value.number===((s=n.mesas.data.find(t=>t.number===a.value.number&&t.id!==o))==null?void 0:s.number)){document.querySelector(".text-red-500").classList.remove("hidden");return}h.put(`/Tables/edit/${o}`,a.value,{onSuccess:()=>{b().success("Mesa actualizada exitosamente"),l.value=!1},onError:t=>{b().error("Error al actualizar la mesa"),console.error("Error al actualizar mesa:",t)}})},S=o=>{A.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar mesa",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&h.delete(`/Tables/${o}`,{onSuccess:()=>{b().success("Mesa eliminada exitosamente")},onError:t=>{b().error("Error al eliminar mesa"),console.error("Error al eliminar mesa:",t)}})})},u=i(""),M=w(()=>u.value?n.mesas.data.filter(o=>o.number.toString().includes(u.value)):n.mesas.data);return(o,s)=>(m(),c(C,null,[e("div",q,[p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),type:"text",placeholder:"Buscar mesa...",class:"border p-2 rounded-lg w-full mb-4"},null,512),[[v,u.value]]),e("table",F,[s[8]||(s[8]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"p-4"},"#"),e("th",{class:"p-4"},"Numero"),e("th",{class:"p-4"},"Estado"),e("th",{class:"p-4"},"Capacidad"),e("th",{class:"p-4"},"Acciones")])],-1)),e("tbody",null,[(m(!0),c(C,null,V(M.value,t=>(m(),c("tr",{key:t.id},[e("td",G,g(t.id),1),e("td",P,g(t.number),1),e("td",I,[r(z,{status:t.status},null,8,["status"])]),e("td",O,g(t.capacity)+" Personas ",1),t.status==="Libre"||t.status==="Reservada"?(m(),c("td",Q,[e("button",{onClick:$=>B(t.id),class:"bg-midBlue hover:bg-strongBlue text-white p-1 rounded"},[...s[6]||(s[6]=[e("img",{src:"/assets/icons/svg/actions/edit.svg",alt:"Editar",class:"w-6"},null,-1)])],8,H),e("button",{onClick:$=>S(t.id),class:"bg-dangerRed hover:bg-red-700 text-white p-1 rounded"},[...s[7]||(s[7]=[e("img",{src:"/assets/icons/svg/actions/delete.svg",alt:"Eliminar",class:"w-6"},null,-1)])],8,J)])):L("",!0)]))),128))])])]),r(R,{show:l.value,"onUpdate:show":s[5]||(s[5]=t=>l.value=t)},{default:_(()=>[e("div",K,[s[12]||(s[12]=e("h3",{class:"text-lg font-bold mb-4"},"Editar Categoría",-1)),e("form",W,[e("div",null,[r(y,{for:"number",value:"Número de Mesa",class:"mb-2"}),p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.value.number=t),type:"text",placeholder:"Numero de Mesa",class:"border p-2 rounded-lg mb-4 w-full"},null,512),[[v,a.value.number]]),r(x,{message:f.value.errors.number},null,8,["message"]),s[9]||(s[9]=e("span",{class:"text-red-500 hidden"},"Este número de mesa ya está en uso.",-1))]),e("div",X,[e("div",null,[r(y,{for:"status",value:"Estado",class:"m-2"}),p(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>a.value.status=t),class:"border p-2 rounded-lg mb-4"},[...s[10]||(s[10]=[e("option",{value:"",disabled:"",selected:""}," Selecciona un estado ",-1),e("option",{value:"Libre"},"Libre",-1),e("option",{value:"Reservada"},"Reservada",-1)])],512),[[j,a.value.status]]),r(x,{message:f.value.errors.status},null,8,["message"])]),e("div",null,[r(y,{for:"capacity",value:"Capacidad",class:"m-2"}),p(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>a.value.capacity=t),type:"text",placeholder:"Capacidad",class:"border p-2 rounded-lg mb-4"},null,512),[[v,a.value.capacity]]),r(x,{message:f.value.errors.capacity},null,8,["message"])])]),e("div",Y,[r(D,{onClick:T},{default:_(()=>[...s[11]||(s[11]=[U("Cancelar",-1)])]),_:1}),e("button",{onClick:s[4]||(s[4]=t=>k(a.value.id)),type:"button",class:"bg-approveGreen hover:bg-green-600 text-white px-4 py-2 rounded-lg self-end"}," Guardar Cambios ")])])])]),_:1},8,["show"])],64))}};export{le as default};
