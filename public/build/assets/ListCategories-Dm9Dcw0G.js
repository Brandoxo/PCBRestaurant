import{r as m,z,j as p,g as l,o as n,b as t,a as d,k as f,q as b,i as x,F as _,s as M,t as C,w as T,S as U,x as k,y as g}from"./app-Dlg-KHGa.js";import{_ as A}from"./Modal-BTmC3dd5.js";import{_ as E}from"./InputLabel-Dzg6hqU3.js";import{_ as B}from"./InputError-Cf3Bi4HB.js";const q={class:"bg-white p-4 rounded-2xl w-full max-w-96 sm:max-w-[40rem] lg:max-w-full mx-auto"},F={class:"overflow-y-auto lg:py-60 lg:h-screen lg:pt-0 scrollbar-hide"},G={class:"w-full mt-2 border"},R={class:"bg-gray-100"},O={key:0,class:"p-4"},P={class:"border p-2 text-center"},Q={class:"border p-2 text-center"},H={class:"border p-2 text-center"},I={class:"border p-2 flex gap-2 justify-center"},J=["onClick"],K=["onClick"],W={class:"p-6"},X={class:"flex flex-col"},Y={class:"flex justify-between"},Z={class:"flex justify-between"},re={__name:"ListCategories",props:{categories:Object},setup(S){const w=m({errors:{}}),r=m({}),i=m(!1),u=S,o=z().props.auth.user,v=p(()=>o&&o.value&&o.includes("Admin")),h=p(()=>(console.log("admin :",o),o&&o.permissions&&o.permissions.includes("delete categories"))),y=p(()=>o&&o.permissions&&o.permissions.includes("edit categories")),$=a=>{i.value=!0,r.value=u.categories.data.find(e=>e.id===a)},N=()=>{i.value=!1},D=a=>{var e;if(r.value.name===((e=u.categories.data.find(s=>s.name===r.value.name&&s.id!==a))==null?void 0:e.name)){document.querySelector(".text-red-500").classList.remove("hidden");return}k.put(`/Categories/edit/${a}`,r.value,{preserveState:!1,replace:!0,onSuccess:()=>{g().success("Categoría actualizada exitosamente"),i.value=!1},onError:s=>{g().error("Error al actualizar la categoría"),console.error("Error al actualizar categoría:",s)}})},V=a=>{U.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(e=>{e.isConfirmed&&k.delete(`/Categories/${a}`,{onSuccess:()=>{g().success("Categoría eliminada exitosamente")},onError:s=>{g().error("Error al eliminar la categoría"),console.error("Error al eliminar categoría:",s)}})})},c=m(""),j=p(()=>c.value?u.categories.data.filter(a=>a.name.toLowerCase().includes(c.value.toLowerCase())):u.categories.data);return(a,e)=>(n(),l(_,null,[t("div",q,[t("form",null,[f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),type:"text",placeholder:"Buscar Categoría...",class:"border p-2 rounded-lg w-full mb-4"},null,512),[[b,c.value]])]),t("div",F,[t("table",G,[t("thead",null,[t("tr",R,[e[5]||(e[5]=t("th",{class:"p-4"},"#",-1)),e[6]||(e[6]=t("th",{class:"p-4"},"Nombre",-1)),e[7]||(e[7]=t("th",{class:"p-4"},"Descripción",-1)),y.value&&h.value||v.value?(n(),l("th",O,"Acciones")):x("",!0)])]),t("tbody",null,[(n(!0),l(_,null,M(j.value,s=>(n(),l("tr",{key:s.id},[t("td",P,C(s.id),1),t("td",Q,C(s.name),1),t("td",H,C(s.description),1),t("td",I,[y.value||v.value?(n(),l("button",{key:0,onClick:L=>$(s.id),class:"bg-midBlue hover:bg-strongBlue text-white p-1 rounded"},[...e[8]||(e[8]=[t("img",{src:"/assets/icons/svg/actions/edit.svg",alt:"Editar",class:"w-6"},null,-1)])],8,J)):x("",!0),h.value||v.value?(n(),l("button",{key:1,onClick:L=>V(s.id),class:"bg-dangerRed hover:bg-red-700 text-white p-1 rounded"},[...e[9]||(e[9]=[t("img",{src:"/assets/icons/svg/actions/delete.svg",alt:"Eliminar",class:"w-6"},null,-1)])],8,K)):x("",!0)])]))),128))])])])]),d(A,{show:i.value,"onUpdate:show":e[4]||(e[4]=s=>i.value=s)},{default:T(()=>[t("div",W,[e[11]||(e[11]=t("h3",{class:"text-lg font-bold mb-4"},"Editar Categoría",-1)),t("form",X,[t("div",Y,[t("div",null,[d(E,{for:"name",value:"Nombre"}),f(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.name=s),type:"text",placeholder:"Nombre de Categoría",class:"border p-2 rounded-lg mb-4 w-full"},null,512),[[b,r.value.name]]),d(B,{message:w.value.errors.name},null,8,["message"]),e[10]||(e[10]=t("span",{class:"text-red-500 hidden"},"Este nombre ya está en uso",-1))]),t("div",null,[d(E,{for:"description",value:"Descripción"}),f(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>r.value.description=s),type:"text",placeholder:"Descripción",class:"border p-2 rounded-lg mb-4 w-full"},null,512),[[b,r.value.description]]),d(B,{message:w.value.errors.description},null,8,["message"])])]),t("div",Z,[t("button",{onClick:N,class:"bg-dangerRed hover:bg-red-700 text-white px-4 py-2 rounded-lg"}," Cancelar "),t("button",{onClick:e[3]||(e[3]=s=>D(r.value.id)),type:"button",class:"bg-approveGreen hover:bg-green-600 text-white px-4 py-2 rounded-lg self-end"}," Guardar Cambios ")])])])]),_:1},8,["show"])],64))}};export{re as default};
