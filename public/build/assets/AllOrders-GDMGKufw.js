import{_ as A}from"./StatusBadge-DgB45FVv.js";import{g as n,o as d,b as t,a as _,f as N,t as i,F as p,q as h,n as T,m as v,y as B,j as D,z as E,G as L,S as m,i as V}from"./app-CxbOl7Wq.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"flex mb- justify-evenly items-center"},$={class:"md:text-lg lg:text-xl"},M={class:"font-extrabold"},q={class:"text-center text-3xl font-bold"},F={class:"flex justify-center items-center text-sm mt-2 gap-2"},G={class:"text-center text-secondary"},H={class:"text-center text-secondary"},J={class:"mt-2 w-full border rounded px-2 py-1"},R=["value"],P={__name:"Orders",props:{order:Object},setup(e){return console.log("order:",e.order.order_details),(b,a)=>(d(),n("div",{class:T(["bg-white p-2 rounded-lg shadow-md mt-4 max-w-md mx-auto w-full",e.order.status==="Cancelada"?"opacity-50 border-2 border-red-500":"",e.order.status==="Completada"?"border-2 border-green-500 opacity-50":""])},[t("div",z,[t("h2",$,[a[0]||(a[0]=N(" Orden ",-1)),t("span",M,"ID #"+i(e.order.id??"0000"),1)]),_(A,{status:e.order.status},null,8,["status"])]),t("h2",q," Mesa "+i(e.order.table.number??"-"),1),t("div",F,[t("p",G,i(e.order.date_time?new Date(e.order.date_time).toLocaleTimeString():"-"),1),a[1]||(a[1]=t("span",{class:"text-secondary"},"|",-1)),t("p",H,i(e.order.date_time?new Date(e.order.date_time).toLocaleDateString():"-"),1)]),t("select",J,[a[2]||(a[2]=t("option",{class:"text-center",disabled:"",selected:""}," Ver menú de la Orden ",-1)),(d(!0),n(p,null,h(e.order.order_details,s=>(d(),n("option",{disabled:"",key:s.id,value:s.product.id},i(s.product.name)+" x"+i(s.quantity),9,R))),128))])],2))}},W=["onClick","gs-x","gs-y","data-gs-id"],K={__name:"AllOrders",props:{orders:Array},emits:["select"],setup(e,{emit:y}){const b=e,a=y,s=v(x()),f=v(null);let c;const g=B().props.auth.user,k=D(()=>g&&g.permissions&&g.permissions.includes("hide orders")),l=v(JSON.parse(localStorage.getItem("deletedOrderIds")||"[]"));function O(){localStorage.setItem("deletedOrderIds",JSON.stringify(l.value))}function x(){return window.innerWidth<1536?1:3}function S(){c&&c.column(x())}return E(()=>{s.value=x(),f.value&&(c=L.init({cellHeight:180,column:s.value,resizable:{handles:"none"},removable:!0,removeTimeout:100},f.value),c.on("removed",function(C,w){w.forEach(r=>{const o=r.el.getAttribute("data-gs-id"),u=b.orders.find(I=>I.id.toString()===o);!l.value.includes(o)&&u.status==="Completada"?(l.value.push(o),m.fire({title:"Orden eliminada",text:"La orden ha sido eliminada correctamente.",icon:"success",confirmButtonText:"Aceptar"}),O()):u.status==="Cancelada"&&k.value?(l.value.push(o),m.fire({title:"Orden Eliminada",text:"Orden Cancelada eliminada exitosamente.",icon:"success",confirmButtonText:"Aceptar"}),O()):u.status==="En curso"?m.fire({title:"Orden en curso...",text:"No es posible eliminar las órdenes en curso.",icon:"error",confirmButtonText:"Aceptar"}).then(()=>{location.reload()}):m.fire({title:"No se puede eliminar",text:"Tus permisos de usuario no permite eliminar Órdenes Canceladas. Solicite a un administrador.",icon:"error",confirmButtonText:"Aceptar"}).then(()=>{location.reload()})})}),window.addEventListener("resize",S))}),(C,w)=>(d(),n("div",{ref_key:"gridRef",ref:f,class:"grid-stack"},[!e.orders||e.orders.length===0?(d(),n(p,{key:0},h(15,r=>t("div",{key:r,class:"animate-pulse bg-gray-300 2xl:w-56 h-28 rounded-lg grid-stack-item"})),64)):V("",!0),(d(!0),n(p,null,h(e.orders.filter(r=>!l.value.includes(r.id.toString())),(r,o)=>(d(),n("div",{key:r.id,onClick:u=>a("select",r),class:"cursor-pointer overflow-y-auto hover:scale-[1.03] transition-all transform ease-in-out duration-300 grid-stack-item","gs-x":o%s.value,"gs-y":Math.floor(o/s.value),"gs-width":1,"gs-height":1,"data-gs-id":r.id},[_(P,{order:r},null,8,["order"])],8,W))),128))],512))}},Y=j(K,[["__scopeId","data-v-06abd498"]]);export{Y as default};
